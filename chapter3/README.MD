# **멀티모달 RAG를 활용한 복합 데이터 처리**  
# **멀티모달 RAG 개요**  
모달리티(modality)는 이미지, 텍스트, 음성 등 입력받거나 처리하는 데이터의 형태를 의미하며 멀티모달(multimodal)은 이러한 서로 다른 유형의 데이터를 
동시에 사용하는 방식을 뜻한다.  
  
# **멀티모달 RAG란?**  
멀티모달 RAG는 단순 텍스트 정보에 의존하는 것이 아니라 이미지나 차트, 테이블 등의 시각적, 구조적 데이터까지 포함하여 정보를 검색하고 생성하는 기법이다.  
  
LLM에 텍스트 데이터뿐 아니라 이미지, 차트, 테이블 등 풍부한 정보를 제공한다면 관련 문서를 검색할 때 더욱 정확한 맥락을 파악할 수 있다. 이를 통해 
보다 일치하는 데이터를 효과적으로 찾아낼 수 있을 뿐 아니라 사용자에게 답변을 생성할 떄도 단순 텍스트를 넘어 다차원적인 정보를 활용할 수 있다. 따라서 
사용자에게 더욱 정확하고 풍부한 답변을 제공할 수 있다.  
  
# **멀티모달 RAG가 어려운 이유**  
멀티모달 RAG는 텍스트 데이터만 활용하는 일반적인 RAG 방식보다 더 많은 난관이 존재한다. 일반적인 비즈니스 도메인에서 다루는 비정형 데이터는 고해상도 
이미지가 담긴 슬라이드 또는 텍스트, 표, 차트, 다이어그램 등이 섞인 형태로 존재하며 PDF 등 다양한 형식으로 분산되어 있는 경우가 많다.  
  
이렇게 서로 다른 여러 형식의 데이터를 다룰 때 각 형식마다 해결해야 할 문제가 다르며 형식 간의 정보를 효과적으로 관리하는 방법도 고민해야 한다. 따라서 
단순히 텍스트만 다루는 일반적인 RAG보다 멀티모달 RAG가 더 복잡한 요소를 고려해야 한다.  
  
## **유형별 상이한 요구사항**  
![img.png](image/img.png)  
  
이미지를 예로 들면 위 그림과 같은 이미지에서는 세부적인 디테일보다는 전반적인 이미지에 중점을 두고 분석하게 된다. 따라서 연못, 바다, 나무, 모래와 같은 
주요 요소만 강조된다.  
  
![img.png](image/img2.png)  
  
반면 보고서나 문서에서는 위 그림과 같은 차트나 다이어그램처럼 정보가 밀집된 이미지가 포함될 수 있다. 이때는 각 수치가 의미하는 바를 해석하는 세부적인 
분석뿐만 아니라 해당 분석이 이루어진 환경과 같은 추가적인 맥락도 고려해야 한다. 따라서 파이프라인을 설계할 때 각 양식의 특성과 요구사항을 인식하고 이에 
맞춰 적절히 처리해야 정보를 효율적으로 담을 수 있다.  
  
## **데이터의 일관성**  
멀티모달 RAG에서 또 다른 중요한 과제는 서로 다른 형식의 데이터를 일관성 있게 관리하는 방법이다. 예를 들어 문서 내에서 차트를 설명하는 텍스트와 차트 
자체의 의미가 일치하는지 확인하는 것이 필수다.  
  
만약 LLM에게 전달되는 두 가지 유형의 정보(텍스트와 차트)가 서로 상반된다면 결국 사용자에게 전달되는 답변 역시 정확도가 떨어질 수 있다. 따라서 다양한 
데이터 형식 간에 일관성을 유지하고 이를 효과적으로 검증하는 과정이 필요하다.  
  
# **멀티모달 RAG 구현 방법**  
멀티모달 RAG 파이프라인을 구축하는 데는 서로 다른 모달리티를 어떻게 LLM에게 인지시킬지에 따라 다음과 같은 몇 가지 주요 접근 방식이 있다.  
  
- 모든 모달리티를 동일한 벡터 공간에 포함하기  
- 모든 모달리티를 하나의 기본 모달리티로 묶기  
- 서로 다른 모달리티를 별도의 저장소에서 다루기  
  
# **모든 모달리티를 동일한 벡터 공간에 포함하기**  
![img.png](image/img3.png)  
  
이미지와 텍스트를 모두 효과적으로 처리하기 위해 CLIP(Contrastive Language-Image Pretraining)과 같은 멀티모달 모델을 사용하면 두 모달리티를 
동일한 벡터 공간에 인코딩할 수 있다. 이를 통해 이미지와 텍스트 모두 동일한 방식으로 임베딩할 수 있으며 기존 텍스트 기반의 RAG 인프라를 그대로 유지하면서 
임베딩 모델만 교체하여 다양한 모달리티를 수용할 수 있다.  
  
이렇게 통합된 벡터 공간을 활용하면 유사도 검색을 통해 이미지와 텍스트를 모두 검색할 수 있고 생성 단계에서는 멀티모달 LLM(MLLM)을 사용하여 이미지와 텍스트 
모두를 활용해 답변을 생성할 수 있다. 이 방식은 이전에 구현했던 RAG 파이프라인에서 임베딩 모델을 교체하는 것 외에 별다른 변화를 요구하지 않으므로 
구현하기 쉽다는 장점이 있다. 하지만 이미지, 텍스트, 복잡한 표 등 다양한 콘텐츠를 정확하게 임베딩할 수 있는 모델을 확보하는 것이 필수다.  
  
